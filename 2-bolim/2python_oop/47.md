# 📚 Darsning mavzusi: Memory Management boshlang'ich umumiy tushunchalar

## Qisqacha vaqt taqsimoti

| Qism                          | Davomiyligi     |
|-------------------------------|-----------------|
| Kirish va Memory Management haqida | 20 daqiqa       |
| Python’da xotira boshqaruvi asoslari | 25 daqiqa       |
| Garbage Collection va xotira optimizatsiyasi | 20 daqiqa       |
| Amaliy mashqlar               | 25 daqiqa       |
| Xulosa va uy vazifasi         | 20 daqiqa       |
| Qayta aloqa va savollar       | 10 daqiqa       |
| Jami                          | 120 daqiqa (2 soat) |

Bu usul yoshlar uchun samarali, qiziqarli va tushunarli bo‘lib, o‘quvchilarni dars jarayoniga faolroq jalb qiladi.

---

# 📖 Darsning batafsil rejasi

## 1. Kirish va Memory Management haqida (20 daqiqa)

Assalomu alaykum, yosh dasturchilar! 😊 Bugun biz dasturlashda juda muhim mavzu — **Memory Management** (xotira boshqaruvi) haqida boshlang‘ich tushunchalarni o‘rganamiz. Xotira boshqaruvi dastur samaradorligi va xavfsizligi uchun juda muhimdir, ayniqsa Python kabi yuqori darajali tillarda.

**Memory Management nima?**  
Xotira boshqaruvi — bu dastur ishlayotganda xotiradan (RAM) qanday foydalanishni boshqarish jarayoni. U obyektlar uchun xotirani ajratish, ulardan foydalanish va kerak bo‘lmaganda xotirani bo‘shatishni o‘z ichiga oladi. Bugun biz quyidagilarni o‘rganamiz:  
- Xotira qanday ajratiladi va bo‘shatiladi.  
- Python’da xotira boshqaruvi qanday ishlaydi.  
- Garbage Collection (axlat yig‘ish) mexanizmi.  

Oddiy misol bilan boshlaymiz:

```python
# Oddiy o‘zgaruvchi yaratish
a = 10
b = [1, 2, 3, 4, 5]
```

Bu yerda `a` va `b` o‘zgaruvchilari uchun xotira ajratildi. Agar ular kerak bo‘lmasa, xotira bo‘shatilishi kerak.

Keling, bir savol: Xotira boshqaruvi nima uchun muhim deb o‘ylaysiz? (O‘quvchilar javobini kutaman, to‘g‘ri javob bo‘lsa: “Ajoyib, to‘g‘ri!” deyman.)

Mashq: Quyidagi vazifani bajaring:  
- `x = "Salom"` va `y = [1, 2, 3]` o‘zgaruvchilarini yarating.  
- Ushbu o‘zgaruvchilar xotirada qayerda saqlanishi haqida o‘ylang (tasavvur qiling).  

5 daqiqa vaqt beraman!

---

## 2. Python’da xotira boshqaruvi asoslari (25 daqiqa)

Endi Python’da xotira boshqaruvi qanday ishlashini o‘rganamiz!

### Xotira ajratish
Python’da har bir obyekt (masalan, son, ro‘yxat, string) yaratilganda xotirada joy ajratiladi. Python avtomatik ravishda xotirani boshqaradi, ya’ni dasturchi xotirani qo‘lda ajratib yoki bo‘shatib o‘tirishi shart emas:

```python
# Xotira ajratish
ism = "Ali"  # String obyekt uchun xotira ajratildi
sonlar = [1, 2, 3]  # Ro‘yxat obyekt uchun xotira ajratildi
```

### Reference Counting (Havola hisobi)
Python’da xotira boshqaruvi asosiy mexanizmlaridan biri — **Reference Counting**. Har bir obyektning havola soni hisoblanadi. Agar obyektga hech qanday havola qolmasa, u avtomatik o‘chiriladi:

```python
import sys

a = "Salom"
print(sys.getrefcount(a))  # Havola sonini ko‘rish (2 yoki undan ko‘p bo‘lishi mumkin)

b = a  # Yana bir havola qo‘shildi
print(sys.getrefcount(a))  # Havola soni oshadi

# Havolani o‘chirish
b = None
print(sys.getrefcount(a))  # Havola soni kamayadi
```

**Eslatma:** `sys.getrefcount()` ichki foydalanish uchun qo‘shimcha havolalarni hisobga olishi mumkin, shuning uchun natijalar kutilganidan yuqori bo‘lishi mumkin.

### Xotira bo‘shatish
Agar obyektning havola soni 0 ga tushsa, Python uni avtomatik o‘chiradi:

```python
a = [1, 2, 3]
a = None  # Havola yo‘q, ro‘yxat xotiradan o‘chiriladi
```

Ammo bu mexanizm har doim ham yetarli emas, chunki tsiklik havolalar bo‘lishi mumkin (masalan, ro‘yxat o‘ziga o‘zi havola qilganda).

Mashq: Quyidagi vazifani bajaring:  
- `sys` modulini import qiling.  
- `s = "Python"` o‘zgaruvchisini yarating va uning havola sonini tekshiring (`sys.getrefcount` bilan).  
- `t = s` qilib, havola sonini yana tekshiring, keyin `t = None` qilib, havola sonini uchinchi marta tekshiring.  

5 daqiqa vaqt beraman!

---

## 3. Garbage Collection va xotira optimizatsiyasi (20 daqiqa)

Ajoyib, endi **Garbage Collection** (axlat yig‘ish) va xotira optimizatsiyasini o‘rganamiz!

### Garbage Collection nima?
Python’da Garbage Collection (GC) — bu xotirani avtomatik bo‘shatish mexanizmi. Reference Counting tsiklik havolalarni aniqlay olmaydi, shuning uchun GC qo‘shimcha yordam beradi:

```python
import gc

# Tsiklik havola misoli
list1 = []
list2 = []
list1.append(list2)  # list1 list2 ga havola qiladi
list2.append(list1)  # list2 list1 ga havola qiladi

# Havolalarni o‘chirish
list1 = None
list2 = None

# Garbage Collection ni qo‘lda ishga tushirish
gc.collect()
print("Tsiklik havolalar tozalandi!")
```

Bu yerda `gc.collect()` qo‘lda chaqirildi, lekin odatda Python buni avtomatik bajaradi.

### Garbage Collection sozlamalari
GC ni o‘chirish yoki sozlash mumkin:

```python
import gc

# GC holatini tekshirish
print(gc.isenabled())  # True

# GC ni o‘chirish
gc.disable()
print(gc.isenabled())  # False

# GC ni qayta yoqish
gc.enable()
print(gc.isenabled())  # True
```

### Xotira optimizatsiyasi uchun maslahatlar
1. **Katta obyektlardan qochish:** Katta ro‘yxatlar yoki lug‘atlar xotirani ko‘p egallaydi. Agar kerak bo‘lmasa, ularni o‘chirish uchun `del` ishlatamiz:

```python
katta_royxat = [0] * 1000000  # Katta ro‘yxat
del katta_royxat  # Xotirani bo‘shatish
```

2. **Generatorlardan foydalanish:** Katta ma’lumotlarni ro‘yxat sifatida saqlash o‘rniga generatorlardan foydalanish xotirani tejaydi:

```python
# Ro‘yxat o‘rniga generator
generator = (i for i in range(1000000))
print(next(generator))  # 0
print(next(generator))  # 1
```

3. **Kichik obyektlarni qayta ishlatish:** Python kichik sonlar va stringlarni qayta ishlatadi (interning):

```python
a = 42
b = 42
print(a is b)  # True (xotirada bir joy ishlatiladi)
```

Mashq: Quyidagi vazifani bajaring:  
- `gc` modulini import qiling va GC holatini tekshiring (`gc.isenabled()`).  
- Katta ro‘yxat yarating (`[0] * 10000`), so‘ng uni `del` bilan o‘chirib, `gc.collect()` ni chaqiring.  
- Generator yarating (`range(5)`) va birinchi ikkita elementni ekranga chiqaring.  

5 daqiqa vaqt beraman!

---

## 4. Amaliy mashqlar (25 daqiqa)

Endi o‘rganganlarimizni amalda sinab ko‘ramiz! Quyidagi mashqlarni qilamiz:

### Mashq 1: Havola hisobi
- `sys` modulini import qiling.  
- `text = "Salom"` o‘zgaruvchisini yarating va uning havola sonini tekshiring.  
- `text2 = text` qilib, havola sonini yana tekshiring, keyin `text2 = None` qilib, yana tekshiring.

```python
import sys

text = "Salom"
print(sys.getrefcount(text))  # Havola soni (3 yoki undan ko‘p bo‘lishi mumkin)
text2 = text
print(sys.getrefcount(text))  # Havola soni oshadi
text2 = None
print(sys.getrefcount(text))  # Havola soni kamayadi
```

### Mashq 2: Garbage Collection
- Tsiklik havola yarating: ikkita ro‘yxat (`list1` va `list2`) bir-biriga havola qilsin.  
- Havolalarni `None` qilib o‘chirib, `gc.collect()` ni chaqiring.

```python
import gc

list1 = []
list2 = []
list1.append(list2)
list2.append(list1)

list1 = None
list2 = None
gc.collect()
print("Tsiklik havolalar tozalandi!")
```

### Mashq 3: Generator bilan ishlash
- `range(1000)` yordamida generator yarating.  
- Birinchi 5 ta elementni ekranga chiqaring (generator yordamida).  
- Katta ro‘yxat yarating (`[0] * 5000`) va uni `del` bilan o‘chiring.

```python
# Generator
gen = (i for i in range(1000))
for _ in range(5):
    print(next(gen))  # 0, 1, 2, 3, 4

# Katta ro‘yxat
katta = [0] * 5000
del katta
print("Katta ro‘yxat o‘chirildi!")
```

Har bir mashq uchun 8-9 daqiqa vaqt beraman. Kodlarni yozib, natijalarni ekranga chiqaring!

---

## 5. Xulosa va uy vazifasi (20 daqiqa)

Ajoyib, yosh dasturchilar! 🎉 Bugun biz xotira boshqaruvi haqida boshlang‘ich tushunchalarni o‘rgandik. Reference Counting, Garbage Collection va xotira optimizatsiyasi usullarini ko‘rdik.

Uyga vazifa sifatida quyidagini qiling:  
1. `sys` modulini ishlatib, `data = "Python"` o‘zgaruvchisini yarating va uning havola sonini tekshiring.  
   - `data2 = data` qilib, havola sonini yana tekshiring.  
   - `data2 = None` qilib, yana tekshiring.  
2. Tsiklik havola yarating (ikkita ro‘yxat bir-biriga havola qilsin), so‘ng ularni `None` qilib, `gc.collect()` ni chaqiring.  
3. `range(10000)` yordamida generator yarating va birinchi 10 ta elementni ekranga chiqaring.  

Darsimiz shu bilan tugadi, keyingi darsda esa `Memory Management advanced` mavzusini o‘rganamiz. Savollaringiz bo‘lsa, yozib qoldiring yoki keyingi darsda so‘rang! 😊

---

## 6. Qayta ko'rib chiqish va savollar (10 daqiqa)

Zo‘r ish qildingiz! Endi bir oz o'rganganlarimizi qayta ko'rib chiqamiz. Bugungi darsda nimalarni o‘rgandik? Kim aytib bera oladi? (O‘quvchilar javobini kutaman.)

- Reference Counting qanday ishlaydi?  
- Garbage Collection qachon kerak bo‘ladi?  
- Xotirani optimizatsiya qilish uchun qanday usullar bor?  

Qandaydir tushunmovchilik bo‘ldimi? Savollaringiz bormi? (O‘quvchilar savollarini eshitaman va tushuntiraman.) 😊

---