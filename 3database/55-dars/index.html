<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database: MongoDB Advanced Queries</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            overflow: hidden;
        }

        .presentation {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .slide {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            display: none;
            animation: slideIn 0.5s ease-in-out;
        }

        .slide.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        h2 {
            color: #764ba2;
            margin-bottom: 20px;
            font-size: 2em;
        }

        h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            border-left: 4px solid #667eea;
        }

        .highlight {
            background: #fed7d7;
            padding: 2px 6px;
            border-radius: 4px;
            color: #c53030;
            font-weight: bold;
        }

        .example-box {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #48bb78;
        }

        .navigation {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .nav-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }

        .nav-btn:hover {
            background: #5a67d8;
        }

        .nav-btn:disabled {
            background: #a0aec0;
            cursor: not-allowed;
        }

        .slide-counter {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
        }

        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .pros, .cons {
            padding: 20px;
            border-radius: 10px;
        }

        .pros {
            background: #c6f6d5;
            border-left: 4px solid #48bb78;
        }

        .cons {
            background: #fed7d7;
            border-left: 4px solid #e53e3e;
        }

        .pros h4, .cons h4 {
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .pros h4 {
            color: #2d7d32;
        }

        .cons h4 {
            color: #c53030;
        }

        ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        li {
            margin: 8px 0;
            line-height: 1.6;
        }

        .use-case {
            background: #e6fffa;
            border: 2px solid #4fd1c7;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .use-case h4 {
            color: #2c7a7b;
            margin-bottom: 10px;
        }

        .python-code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            border-left: 4px solid #f6ad55;
        }
    </style>
</head>
<body>
    <div class="presentation">
        <div class="slide-counter">
            <span id="currentSlide">1</span> / <span id="totalSlides">8</span>
        </div>

        <!-- Slide 1: Title -->
        <div class="slide active">
            <h1>üîç MongoDB Advanced Queries</h1>
            <div class="example-box">
                <h3>üéØ Darsning Maqsadi</h3>
                <p>MongoDB'da murakkab so'rovlar, aggregation pipeline va optimizatsiya texnikalarini o'rganish.</p>
            </div>
            <div class="example-box">
                <h3>üìã Dars Rejasi</h3>
                <ul>
                    <li>Query operators</li>
                    <li>Aggregation pipeline</li>
                    <li>Indexing</li>
                    <li>Performance optimization</li>
                    <li>Real-world examples</li>
                </ul>
            </div>
        </div>

        <!-- Slide 2: Query Operators -->
        <div class="slide">
            <h2>üîç Query Operators</h2>
            <div class="example-box">
                <h3>üìä Comparison Operators</h3>
            </div>
            
            <div class="code-block">
// Taqqoslash operatorlari
db.users.find({ age: { $gte: 18, $lte: 65 } })
db.users.find({ age: { $gt: 25 } })
db.users.find({ age: { $lt: 30 } })
db.users.find({ age: { $ne: 25 } })
db.users.find({ age: { $in: [25, 30, 35] } })
db.users.find({ age: { $nin: [18, 65] } })

// Mavjudlik tekshirish
db.users.find({ email: { $exists: true } })
db.users.find({ phone: { $exists: false } })

// Null qiymatlar
db.users.find({ bio: { $eq: null } })
db.users.find({ bio: { $ne: null } })
            </div>

            <div class="example-box">
                <h3>üî§ String Operators</h3>
            </div>
            
            <div class="code-block">
// Matn operatorlari
db.users.find({ username: { $regex: /^j/, $options: 'i' } })
db.users.find({ email: { $regex: /@gmail\.com$/ } })
db.users.find({ firstName: { $regex: /john/i } })

// Matn uzunligi
db.users.find({ bio: { $exists: true, $ne: "" } })
db.users.find({ bio: { $regex: /.{10,}/ } })
            </div>
        </div>

        <!-- Slide 3: Logical Operators -->
        <div class="slide">
            <h2>üß† Logical Operators</h2>
            <div class="example-box">
                <h3>üîó AND, OR, NOT</h3>
            </div>
            
            <div class="code-block">
// AND operatori (default)
db.users.find({ 
    age: { $gte: 18 }, 
    isActive: true 
})

// OR operatori
db.users.find({ 
    $or: [
        { age: { $gte: 65 } },
        { age: { $lt: 18 } }
    ]
})

// NOT operatori
db.users.find({ 
    $not: { age: { $gte: 25 } } 
})

// Murakkab mantiq
db.users.find({
    $and: [
        { isActive: true },
        { 
            $or: [
                { age: { $gte: 18 } },
                { role: "admin" }
            ]
        }
    ]
})
            </div>

            <div class="example-box">
                <h3>üìä Array Operators</h3>
            </div>
            
            <div class="code-block">
// Massiv operatorlari
db.users.find({ hobbies: "reading" })
db.users.find({ hobbies: { $all: ["reading", "gaming"] } })
db.users.find({ hobbies: { $size: 3 } })
db.users.find({ hobbies: { $elemMatch: { $regex: /^r/ } } })

// Nested array
db.users.find({ 
    "addresses.city": "New York" 
})
db.users.find({ 
    "addresses": { 
        $elemMatch: { 
            city: "New York", 
            isPrimary: true 
        } 
    } 
})
            </div>
        </div>

        <!-- Slide 4: Aggregation Pipeline -->
        <div class="slide">
            <h2>üìà Aggregation Pipeline</h2>
            <div class="example-box">
                <h3>üîß Pipeline Stages</h3>
            </div>
            
            <div class="code-block">
// Oddiy aggregation
db.users.aggregate([
    { $match: { isActive: true } },
    { $group: { 
        _id: "$age", 
        count: { $sum: 1 },
        avgScore: { $avg: "$score" }
    }},
    { $sort: { count: -1 } },
    { $limit: 10 }
])

// Lookup (JOIN o'rniga)
db.posts.aggregate([
    {
        $lookup: {
            from: "users",
            localField: "authorId",
            foreignField: "_id",
            as: "author"
        }
    },
    { $unwind: "$author" },
    { $project: { 
        title: 1, 
        content: 1, 
        "author.username": 1,
        "author.email": 1 
    }}
])
            </div>

            <div class="example-box">
                <h3>üìä Advanced Aggregation</h3>
            </div>
            
            <div class="code-block">
// Murakkab tahlil
db.orders.aggregate([
    // Faqat oxirgi 30 kun
    { $match: { 
        createdAt: { $gte: new Date(Date.now() - 30*24*60*60*1000) } 
    }},
    
    // Guruhlash
    { $group: {
        _id: "$customerId",
        totalOrders: { $sum: 1 },
        totalAmount: { $sum: "$amount" },
        avgAmount: { $avg: "$amount" },
        lastOrder: { $max: "$createdAt" }
    }},
    
    // Filtrlash
    { $match: { totalOrders: { $gte: 5 } } },
    
    // Tartiblash
    { $sort: { totalAmount: -1 } },
    
    // Cheklash
    { $limit: 10 }
])
            </div>
        </div>

        <!-- Slide 5: Indexing -->
        <div class="slide">
            <h2>üìá Indexing</h2>
            <div class="example-box">
                <h3>üîç Index Turlari</h3>
            </div>
            
            <div class="code-block">
// Oddiy index
db.users.createIndex({ username: 1 })
db.users.createIndex({ email: 1 })

// Compound index
db.users.createIndex({ 
    isActive: 1, 
    createdAt: -1 
})

// Text index
db.posts.createIndex({ 
    title: "text", 
    content: "text" 
})

// Geospatial index
db.locations.createIndex({ 
    coordinates: "2dsphere" 
})

// Unique index
db.users.createIndex({ 
    email: 1 
}, { unique: true })

// Partial index
db.users.createIndex({ 
    score: 1 
}, { 
    partialFilterExpression: { 
        isActive: true 
    } 
})
            </div>

            <div class="use-case">
                <h4>‚ö° Performance Tips</h4>
                <ul>
                    <li><strong>Query patterns</strong> - Qanday so'rovlar ko'p ishlatiladi</li>
                    <li><strong>Compound indexes</strong> - Ko'p ustunli indexlar</li>
                    <li><strong>Covered queries</strong> - Index orqali to'liq javob</li>
                    <li><strong>Index intersection</strong> - Bir necha indexni birlashtirish</li>
                </ul>
            </div>
        </div>

        <!-- Slide 6: Performance Optimization -->
        <div class="slide">
            <h2>‚ö° Performance Optimization</h2>
            <div class="example-box">
                <h3>üìä Query Analysis</h3>
            </div>
            
            <div class="code-block">
// Explain query
db.users.find({ 
    age: { $gte: 25 }, 
    isActive: true 
}).explain("executionStats")

// Profiling
db.setProfilingLevel(2, { slowms: 100 })
db.system.profile.find().sort({ ts: -1 }).limit(5)

// Index usage
db.users.aggregate([
    { $indexStats: {} }
])

// Query optimization
db.users.find({ 
    age: { $gte: 25 }, 
    isActive: true 
}).hint({ age: 1, isActive: 1 })
            </div>

            <div class="pros-cons">
                <div class="pros">
                    <h4>‚úÖ Optimization Tips</h4>
                    <ul>
                        <li><strong>Indexes</strong> - To'g'ri indexlar</li>
                        <li><strong>Projection</strong> - Kerakli ustunlar</li>
                        <li><strong>Limit</strong> - Natijalarni cheklash</li>
                        <li><strong>Skip</strong> - Skip o'rniga cursor</li>
                    </ul>
                </div>
                <div class="cons">
                    <h4>‚ö†Ô∏è Avoid</h4>
                    <ul>
                        <li><strong>Large documents</strong> - Katta hujjatlar</li>
                        <li><strong>N+1 queries</strong> - Ko'p so'rovlar</li>
                        <li><strong>Regex without index</strong> - Indexsiz regex</li>
                        <li><strong>Large sorts</strong> - Katta tartiblash</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 7: Real-world Examples -->
        <div class="slide">
            <h2>üíº Real-world Examples</h2>
            <div class="example-box">
                <h3>üì± E-commerce Analytics</h3>
            </div>
            
            <div class="code-block">
// Eng ko'p sotilgan mahsulotlar
db.orders.aggregate([
    { $unwind: "$items" },
    { $group: {
        _id: "$items.productId",
        totalSold: { $sum: "$items.quantity" },
        totalRevenue: { $sum: { $multiply: ["$items.quantity", "$items.price"] }}
    }},
    { $lookup: {
        from: "products",
        localField: "_id",
        foreignField: "_id",
        as: "product"
    }},
    { $unwind: "$product" },
    { $project: {
        productName: "$product.name",
        totalSold: 1,
        totalRevenue: 1
    }},
    { $sort: { totalSold: -1 } },
    { $limit: 10 }
])
            </div>

            <div class="example-box">
                <h3>üìä User Behavior Analysis</h3>
            </div>
            
            <div class="code-block">
// Foydalanuvchi faollik tahlili
db.user_activities.aggregate([
    { $match: { 
        timestamp: { $gte: new Date("2024-01-01") } 
    }},
    { $group: {
        _id: "$userId",
        totalActivities: { $sum: 1 },
        uniqueDays: { $addToSet: { $dateToString: { 
            format: "%Y-%m-%d", 
            date: "$timestamp" 
        }}},
        lastActivity: { $max: "$timestamp" }
    }},
    { $addFields: {
        activeDays: { $size: "$uniqueDays" }
    }},
    { $match: { 
        totalActivities: { $gte: 10 },
        activeDays: { $gte: 5 }
    }},
    { $sort: { totalActivities: -1 } }
])
            </div>
        </div>

        <!-- Slide 8: Summary -->
        <div class="slide">
            <h2>üìù Xulosa</h2>
            <div class="example-box">
                <h3>üéØ O'rganilgan Mavzular</h3>
                <ul>
                    <li>Query operators va mantiqiy operatorlar</li>
                    <li>Aggregation pipeline va murakkab tahlil</li>
                    <li>Indexing va performance optimization</li>
                    <li>Real-world misollar va best practices</li>
                    <li>Query analysis va monitoring</li>
                </ul>
            </div>
            
            <div class="pros-cons">
                <div class="pros">
                    <h4>‚úÖ Keyingi Qadamlar</h4>
                    <ul>
                        <li>Replica Sets</li>
                        <li>Sharding</li>
                        <li>Change Streams</li>
                        <li>Atlas Cloud</li>
                    </ul>
                </div>
                <div class="cons">
                    <h4>üí° Maslahatlar</h4>
                    <ul>
                        <li>Query patterns'ni tahlil qiling</li>
                        <li>Indexlarni optimizatsiya qiling</li>
                        <li>Performance monitoring</li>
                        <li>Best practices'ga rioya qiling</li>
                    </ul>
                </div>
            </div>
            
            <div class="use-case">
                <h4>üèÜ Amaliy Mashq</h4>
                <p>MongoDB bilan to'liq analytics tizimi yarating!</p>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn" id="prevBtn" onclick="changeSlide(-1)">‚¨ÖÔ∏è Orqaga</button>
            <button class="nav-btn" id="nextBtn" onclick="changeSlide(1)">Keyingi ‚û°Ô∏è</button>
        </div>
    </div>

    <script>
        let currentSlideIndex = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;
        
        document.getElementById('totalSlides').textContent = totalSlides;

        function showSlide(index) {
            slides.forEach(slide => slide.classList.remove('active'));
            slides[index].classList.add('active');
            document.getElementById('currentSlide').textContent = index + 1;
            
            // Update navigation buttons
            document.getElementById('prevBtn').disabled = index === 0;
            document.getElementById('nextBtn').disabled = index === totalSlides - 1;
        }

        function changeSlide(direction) {
            const newIndex = currentSlideIndex + direction;
            if (newIndex >= 0 && newIndex < totalSlides) {
                currentSlideIndex = newIndex;
                showSlide(currentSlideIndex);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                changeSlide(-1);
            } else if (e.key === 'ArrowRight') {
                changeSlide(1);
            }
        });

        // Initialize
        showSlide(0);
    </script>
</body>
</html>
