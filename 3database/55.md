---

# 📚 Darsning mavzusi: PostgreSQL Where, Order By

## Qisqacha vaqt taqsimoti

| Qism                          | Davomiyligi     |
|-------------------------------|-----------------|
| Kirish va Where, Order By haqida | 20 daqiqa       |
| Where va Order By bilan ishlash | 25 daqiqa       |
| Python bilan Where va Order By so‘rovlar | 20 daqiqa       |
| Amaliy mashqlar               | 25 daqiqa       |
| Xulosa va uy vazifasi         | 20 daqiqa       |
| Qayta aloqa va savollar       | 10 daqiqa       |
| Jami                          | 120 daqiqa (2 soat) |

Bu usul yoshlar uchun samarali, qiziqarli va tushunarli bo‘lib, o‘quvchilarni dars jarayoniga faolroq jalb qiladi.

---

# 📖 Darsning batafsil rejasi

## 1. Kirish va Where, Order By haqida (20 daqiqa)

Assalomu alaykum, yosh dasturchilar! 😊 Bugun biz PostgreSQL’da ma’lumotlarni filtrlash va tartiblash uchun ishlatiladigan **WHERE** va **ORDER BY** so‘rovlarini o‘rganamiz. Bu so‘rovlar ma’lumotlar bazasidan ma’lumotlarni kerakli shartlar asosida olish va tartibda ko‘rsatish uchun juda muhim.

**WHERE va ORDER BY nima?**  
- **WHERE:** Ma’lumotlarni filtrlash uchun shart qo‘yadi (masalan, narxi 100 dan yuqori bo‘lgan mahsulotlar).  
- **ORDER BY:** Ma’lumotlarni tartiblash uchun ishlatiladi (masalan, narx bo‘yicha o‘sish tartibida).  

Bugun biz quyidagilarni o‘rganamiz:  
- WHERE yordamida ma’lumotlarni qanday filtrlash.  
- ORDER BY bilan ma’lumotlarni qanday tartiblash.  
- Python’da ushbu so‘rovlar bilan ishlash.  

**Nima uchun bu muhim?**  
Ma’lumotlarni filtrlash va tartiblash real loyihalarda, masalan, mahsulotlarni narx bo‘yicha tartiblash yoki faqat ma’lum shartlarga mos foydalanuvchilarni ko‘rsatishda kerak bo‘ladi.

Keling, bir savol: Ma’lumotlarni tartiblash qanday hollarda foydali bo‘ladi deb o‘ylaysiz? (O‘quvchilar javobini kutaman, to‘g‘ri javob bo‘lsa: “Ajoyib, to‘g‘ri!” deyman.)

Mashq: Quyidagi vazifani bajaring:  
- WHERE va ORDER BY haqida o‘zingizning taxminiy tushunchangizni yozing (qog‘ozda yoki fikr sifatida).  
- Qanday loyiha uchun ma’lumotlarni tartiblash kerak bo‘lishi mumkin (masalan, onlayn do‘kon)?  

5 daqiqa vaqt beraman!

---

## 2. Where va Order By bilan ishlash (25 daqiqa)

Endi PostgreSQL’da WHERE va ORDER BY so‘rovlarini o‘rganamiz!

### Tayyor jadval
Avval bir jadval yaratamiz va unga ma’lumot qo‘shamiz:  
```sql
-- Ma’lumotlar bazasi va jadval yaratish
CREATE DATABASE shop;
\c shop

CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    nomi VARCHAR(50),
    narxi INTEGER,
    turi VARCHAR(20)
);

-- Ma’lumot qo‘shish
INSERT INTO products (nomi, narxi, turi) VALUES ('Telefon', 500, 'Elektronika');
INSERT INTO products (nomi, narxi, turi) VALUES ('Noutbuk', 800, 'Elektronika');
INSERT INTO products (nomi, narxi, turi) VALUES ('Kiyim', 50, 'Moda');
INSERT INTO products (nomi, narxi, turi) VALUES ('Aksessuar', 20, 'Moda');
```

### WHERE bilan filtrlash
**WHERE** yordamida ma’lumotlarni shart asosida tanlaymiz:  
```sql
-- Narxi 100 dan yuqori bo‘lgan mahsulotlarni olish
SELECT * FROM products WHERE narxi > 100;
-- Natija:
-- id | nomi    | narxi | turi
-- 1  | Telefon | 500   | Elektronika
-- 2  | Noutbuk | 800   | Elektronika

-- Turi "Moda" bo‘lgan mahsulotlarni olish
SELECT * FROM products WHERE turi = 'Moda';
-- Natija:
-- id | nomi      | narxi | turi
-- 3  | Kiyim     | 50    | Moda
-- 4  | Aksessuar | 20    | Moda

-- Murakkab shart: Narxi 100 dan kichik va turi "Moda"
SELECT * FROM products WHERE narxi < 100 AND turi = 'Moda';
-- Natija:
-- id | nomi      | narxi | turi
-- 3  | Kiyim     | 50    | Moda
-- 4  | Aksessuar | 20    | Moda
```

### ORDER BY bilan tartiblash
**ORDER BY** yordamida ma’lumotlarni tartiblash:  
```sql
-- Narx bo‘yicha o‘sish tartibida
SELECT * FROM products ORDER BY narxi ASC;
-- Natija:
-- id | nomi      | narxi | turi
-- 4  | Aksessuar | 20    | Moda
-- 3  | Kiyim     | 50    | Moda
-- 1  | Telefon   | 500   | Elektronika
-- 2  | Noutbuk   | 800   | Elektronika

-- Narx bo‘yicha kamayish tartibida
SELECT * FROM products ORDER BY narxi DESC;
-- Natija:
-- id | nomi      | narxi | turi
-- 2  | Noutbuk   | 800   | Elektronika
-- 1  | Telefon   | 500   | Elektronika
-- 3  | Kiyim     | 50    | Moda
-- 4  | Aksessuar | 20    | Moda
```

### WHERE va ORDER BY birgalikda
WHERE va ORDER BY’ni birgalikda ishlatish:  
```sql
-- Turi "Elektronika" bo‘lgan mahsulotlarni narx bo‘yicha o‘sish tartibida olish
SELECT * FROM products WHERE turi = 'Elektronika' ORDER BY narxi ASC;
-- Natija:
-- id | nomi    | narxi | turi
-- 1  | Telefon | 500   | Elektronika
-- 2  | Noutbuk | 800   | Elektronika

-- Narxi 100 dan kichik bo‘lgan mahsulotlarni nomi bo‘yicha tartiblash
SELECT * FROM products WHERE narxi < 100 ORDER BY nomi ASC;
-- Natija:
-- id | nomi      | narxi | turi
-- 4  | Aksessuar | 20    | Moda
-- 3  | Kiyim     | 50    | Moda
```

**Eslatma:** Bu darsda biz faqat so‘rovlar va natijalarni tasavvur qilamiz, chunki real ulanish muhitga bog‘liq.

Mashq: Quyidagi vazifani bajaring:  
- `students` nomli jadval yarating (id, ism, baho).  
- 4 ta talaba qo‘shing (masalan, Ali, 5; Zilola, 4; Vali, 3; Mohira, 5).  
- Bahosi 4 dan yuqori bo‘lgan talabalarni ism bo‘yicha tartiblang.  

5 daqiqa vaqt beraman!

---

## 3. Python bilan Where va Order By so‘rovlar (20 daqiqa)

Ajoyib, endi Python yordamida WHERE va ORDER BY so‘rovlar bilan ishlashni o‘rganamiz!

### `psycopg2` bilan ulanish
Python’da PostgreSQL bilan ishlash uchun `psycopg2` ishlatamiz:

```python
import psycopg2

# PostgreSQL’ga ulanish
try:
    conn = psycopg2.connect(
        database="shop",
        user="postgres",
        password="admin123",
        host="localhost",
        port="5432"
    )
    cursor = conn.cursor()
    print("Bazaga ulanildi!")

    # WHERE bilan filtrlash
    cursor.execute("SELECT * FROM products WHERE narxi > %s", (100,))
    natija = cursor.fetchall()
    print("Narxi 100 dan yuqori mahsulotlar:", natija)
    # Natija: [(1, 'Telefon', 500, 'Elektronika'), (2, 'Noutbuk', 800, 'Elektronika')]

    # ORDER BY bilan tartiblash
    cursor.execute("SELECT * FROM products ORDER BY narxi DESC")
    natija = cursor.fetchall()
    print("Narx bo‘yicha kamayish tartibida:", natija)
    # Natija: [(2, 'Noutbuk', 800, 'Elektronika'), (1, 'Telefon', 500, 'Elektronika'), ...]

    # WHERE va ORDER BY birgalikda
    cursor.execute("SELECT * FROM products WHERE turi = %s ORDER BY narxi ASC", ("Moda",))
    natija = cursor.fetchall()
    print("Turi Moda bo‘lgan mahsulotlar, narx bo‘yicha o‘sish tartibida:", natija)
    # Natija: [(4, 'Aksessuar', 20, 'Moda'), (3, 'Kiyim', 50, 'Moda')]

except psycopg2.Error as xato:
    print(f"Xato: {xato}")
finally:
    cursor.close()
    conn.close()
    print("Ulanish yopildi!")
```

**Tushuntirish:**  
- `cursor.execute` yordamida WHERE va ORDER BY so‘rovlarini bajarish mumkin.  
- `%s` o‘rniga qiymatlar qo‘yish xavfsiz usul (SQL injection’ni oldini oladi).  
- `fetchall()` barcha natijalarni ro‘yxat sifatida qaytaradi.  

**Eslatma:** Bu darsda biz faqat kodni ko‘rib chiqamiz, chunki real ulanish muhitga bog‘liq.

Mashq: Quyidagi vazifani bajaring:  
- Python’da `employees` nomli jadval yarating (id, name, salary).  
- 4 ta xodim qo‘shing (masalan, Ali, 1500; Vali, 1200; Zilola, 900; Mohira, 2000).  
- Maoshi 1000 dan yuqori bo‘lgan xodimlarni maosh bo‘yicha kamayish tartibida toping.  

5 daqiqa vaqt beraman!

---

## 4. Amaliy mashqlar (25 daqiqa)

Endi o‘rganganlarimizni amalda sinab ko‘ramiz! Quyidagi mashqlarni qilamiz:

### Mashq 1: SQL’da WHERE va ORDER BY
- `books` nomli jadval yarating (id, title, price).  
- 4 ta kitob qo‘shing (masalan, Python 101, 60; Java Basics, 40; Data Science, 80; AI Intro, 90).  
- Narxi 50 dan yuqori bo‘lgan kitoblarni narx bo‘yicha kamayish tartibida toping.

```sql
-- Jadval yaratish
CREATE TABLE books (
    id SERIAL PRIMARY KEY,
    title VARCHAR(100),
    price INTEGER
);

-- Ma’lumot qo‘shish
INSERT INTO books (title, price) VALUES ('Python 101', 60);
INSERT INTO books (title, price) VALUES ('Java Basics', 40);
INSERT INTO books (title, price) VALUES ('Data Science', 80);
INSERT INTO books (title, price) VALUES ('AI Intro', 90);

-- Narxi 50 dan yuqori bo‘lgan kitoblarni tartiblash
SELECT * FROM books WHERE price > 50 ORDER BY price DESC;
-- Natija:
-- id | title        | price
-- 4  | AI Intro     | 90
-- 3  | Data Science | 80
-- 1  | Python 101   | 60
```

### Mashq 2: Python’da WHERE va ORDER BY
- `students` nomli jadval yarating (id, ism, baho).  
- 4 ta talaba qo‘shing.  
- Bahosi 4 dan yuqori bo‘lgan talabalarni ism bo‘yicha tartiblang.

```python
import psycopg2

try:
    conn = psycopg2.connect(
        database="shop",
        user="postgres",
        password="admin123",
        host="localhost",
        port="5432"
    )
    cursor = conn.cursor()

    # Jadval yaratish
    cursor.execute('''CREATE TABLE IF NOT EXISTS students (
        id SERIAL PRIMARY KEY,
        ism VARCHAR(50),
        baho INTEGER
    )''')

    # Ma’lumot qo‘shish
    cursor.execute("INSERT INTO students (ism, baho) VALUES (%s, %s)", ("Ali", 5))
    cursor.execute("INSERT INTO students (ism, baho) VALUES (%s, %s)", ("Zilola", 4))
    cursor.execute("INSERT INTO students (ism, baho) VALUES (%s, %s)", ("Vali", 3))
    cursor.execute("INSERT INTO students (ism, baho) VALUES (%s, %s)", ("Mohira", 5))
    conn.commit()

    # Bahosi 4 dan yuqori bo‘lgan talabalarni tartiblash
    cursor.execute("SELECT * FROM students WHERE baho > %s ORDER BY ism ASC", (4,))
    natija = cursor.fetchall()
    print(natija)  # [(1, 'Ali', 5), (4, 'Mohira', 5)]

except psycopg2.Error as xato:
    print(f"Xato: {xato}")
finally:
    cursor.close()
    conn.close()
```

### Mashq 3: Murakkab shartlar bilan tartiblash
- Yuqoridagi `students` jadvalida:  
  - Bahosi 3 dan kichik yoki 5 ga teng bo‘lgan talabalarni baho bo‘yicha o‘sish tartibida toping.  
  - Natijani ko‘rish so‘rovini yozing.

```sql
-- Bahosi 3 dan kichik yoki 5 ga teng bo‘lgan talabalarni tartiblash
SELECT * FROM students WHERE baho < 3 OR baho = 5 ORDER BY baho ASC;
-- Natija:
-- id | ism    | baho
-- 1  | Ali    | 5
-- 4  | Mohira | 5
```

Har bir mashq uchun 8-9 daqiqa vaqt beraman. Kodlarni yozib, natijalarni ekranga chiqaring!

---

## 5. Xulosa va uy vazifasi (20 daqiqa)

Ajoyib, yosh dasturchilar! 🎉 Bugun biz PostgreSQL’da WHERE va ORDER BY so‘rovlar bilan ishlashni o‘rgandik. SQL va Python yordamida ma’lumotlarni qanday filtrlash va tartiblashni ko‘rdik.

Uyga vazifa sifatida quyidagini qiling:  
1. `employees` nomli jadval yarating (id, name, salary).  
   - 4 ta xodim qo‘shing (SQL’da).  
   - Maoshi 1000 dan yuqori bo‘lgan xodimlarni maosh bo‘yicha o‘sish tartibida toping.  
2. Python’da `products` nomli jadval yarating (id, nomi, narxi).  
   - 4 ta mahsulot qo‘shing.  
   - Narxi 50 dan kichik yoki 500 ga teng bo‘lgan mahsulotlarni nomi bo‘yicha tartiblang.  
3. Yuqoridagi `products` jadvalida narxi 100 dan yuqori bo‘lgan mahsulotlarni narx bo‘yicha kamayish tartibida toping (SQL’da).  

Darsimiz shu bilan tugadi, keyingi darsda esa `PostgreSQL Drop Table, MySQL Limit, MySQL Join` mavzusini o‘rganamiz. Savollaringiz bo‘lsa, yozib qoldiring yoki keyingi darsda so‘rang! 😊

---

## 6. Qayta ko'rib chiqish va savollar (10 daqiqa)

Zo‘r ish qildingiz! Endi bir oz o'rganganlarimizi qayta ko'rib chiqamiz. Bugungi darsda nimalarni o‘rgandik? Kim aytib bera oladi? (O‘quvchilar javobini kutaman.)

- WHERE qanday shartlar qo‘yishda ishlatiladi?  
- ORDER BY qanday tartiblash imkonini beradi?  
- Python’da so‘rovlar qanday bajarildi?  

Qandaydir tushunmovchilik bo‘ldimi? Savollaringiz bormi? (O‘quvchilar savollarini eshitaman va tushuntiraman.) 😊

---
