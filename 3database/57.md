---

# 📚 Darsning mavzusi: PostgreSQL bilan Loyiha – Onlayn Do‘kon Ma’lumotlar Bazasi

## Qisqacha vaqt taqsimoti

| Qism                          | Davomiyligi     |
|-------------------------------|-----------------|
| Kirish va loyiha haqida        | 20 daqiqa       |
| Ma’lumotlar bazasi va jadvallar yaratish | 25 daqiqa       |
| Python bilan ma’lumotlarni boshqarish | 20 daqiqa       |
| Amaliy mashqlar va loyiha kengaytirish | 25 daqiqa       |
| Xulosa va uy vazifasi         | 20 daqiqa       |
| Qayta aloqa va savollar       | 10 daqiqa       |
| Jami                          | 120 daqiqa (2 soat) |

Bu usul yoshlar uchun samarali, qiziqarli va tushunarli bo‘lib, o‘quvchilarni dars jarayoniga faolroq jalb qiladi.

---

# 📖 Darsning batafsil rejasi

## 1. Kirish va loyiha haqida (20 daqiqa)

Assalomu alaykum, yosh dasturchilar! 😊 Bugun biz PostgreSQL’da o‘rgangan barcha bilimlarimizni amalda qo‘llab, kichik bir loyiha qilamiz. Bizning loyihamiz – **Onlayn Do‘kon Ma’lumotlar Bazasi**. Bu loyiha orqali siz ma’lumotlar bazasi va jadvallarni yaratish, ma’lumotlarni qo‘shish, filtrlash, tartiblash va Python bilan ishlashni o‘rganasiz.

**Loyiha haqida:**  
Biz onlayn do‘kon uchun ma’lumotlar bazasi tuzamiz. Unda quyidagi jadvallar bo‘ladi:  
- `products` (mahsulotlar): id, nomi, narxi, turi.  
- `customers` (mijozlar): id, ism, telefon.  
- `orders` (buyurtmalar): id, customer_id, product_id, miqdor.  

Bugun biz quyidagilarni amalga oshiramiz:  
- Ma’lumotlar bazasi va jadvallarni yaratish.  
- Ma’lumotlar qo‘shish, filtrlash va tartiblash.  
- Python yordamida ma’lumotlarni boshqarish.  

**Nima uchun bu muhim?**  
Bu loyiha PostgreSQL’dagi barcha bilimlaringizni birlashtiradi va real dunyo loyihalariga tayyorgarlik ko‘rishga yordam beradi.

Keling, bir savol: Onlayn do‘kon ma’lumotlar bazasida qanday ma’lumotlarni saqlash kerak deb o‘ylaysiz? (O‘quvchilar javobini kutaman, to‘g‘ri javob bo‘lsa: “Ajoyib, to‘g‘ri!” deyman.)

Mashq: Quyidagi vazifani bajaring:  
- Onlayn do‘kon uchun qanday jadvallar kerak bo‘lishi mumkinligini o‘ylang (qog‘ozda yoki fikr sifatida).  
- Qanday ma’lumotlarni filtrlash yoki tartiblash foydali bo‘ladi (masalan, narxi bo‘yicha tartiblash)?  

5 daqiqa vaqt beraman!

---

## 2. Ma’lumotlar bazasi va jadvallar yaratish (25 daqiqa)

Endi loyihamizni boshlaymiz! PostgreSQL’da ma’lumotlar bazasi va jadvallar yaratamiz.

### Ma’lumotlar bazasi yaratish
```sql
-- Ma’lumotlar bazasi yaratish
CREATE DATABASE onlinedokon;
\c onlinedokon
```

### Jadvallar yaratish
Uchta jadval yaratamiz: `products`, `customers` va `orders`.

#### 1. `products` jadvali
```sql
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    nomi VARCHAR(50),
    narxi INTEGER,
    turi VARCHAR(20)
);

-- Ma’lumot qo‘shish
INSERT INTO products (nomi, narxi, turi) VALUES ('Telefon', 500, 'Elektronika');
INSERT INTO products (nomi, narxi, turi) VALUES ('Noutbuk', 800, 'Elektronika');
INSERT INTO products (nomi, narxi, turi) VALUES ('Kiyim', 50, 'Moda');
INSERT INTO products (nomi, narxi, turi) VALUES ('Aksessuar', 20, 'Moda');

-- Ma’lumotlarni ko‘rish
SELECT * FROM products;
-- Natija:
-- id | nomi      | narxi | turi
-- 1  | Telefon   | 500   | Elektronika
-- 2  | Noutbuk   | 800   | Elektronika
-- 3  | Kiyim     | 50    | Moda
-- 4  | Aksessuar | 20    | Moda
```

#### 2. `customers` jadvali
```sql
CREATE TABLE customers (
    id SERIAL PRIMARY KEY,
    ism VARCHAR(50),
    telefon VARCHAR(20)
);

-- Ma’lumot qo‘shish
INSERT INTO customers (ism, telefon) VALUES ('Ali', '+998901234567');
INSERT INTO customers (ism, telefon) VALUES ('Zilola', '+998907654321');
INSERT INTO customers (ism, telefon) VALUES ('Vali', '+998909876543');

-- Ma’lumotlarni ko‘rish
SELECT * FROM customers;
-- Natija:
-- id | ism    | telefon
-- 1  | Ali    | +998901234567
-- 2  | Zilola | +998907654321
-- 3  | Vali   | +998909876543
```

#### 3. `orders` jadvali
```sql
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    customer_id INTEGER REFERENCES customers(id),
    product_id INTEGER REFERENCES products(id),
    miqdor INTEGER
);

-- Ma’lumot qo‘shish
INSERT INTO orders (customer_id, product_id, miqdor) VALUES (1, 1, 2); -- Ali 2 ta Telefon sotib oldi
INSERT INTO orders (customer_id, product_id, miqdor) VALUES (2, 2, 1); -- Zilola 1 ta Noutbuk sotib oldi
INSERT INTO orders (customer_id, product_id, miqdor) VALUES (3, 3, 3); -- Vali 3 ta Kiyim sotib oldi

-- Ma’lumotlarni ko‘rish
SELECT * FROM orders;
-- Natija:
-- id | customer_id | product_id | miqdor
-- 1  | 1          | 1         | 2
-- 2  | 2          | 2         | 1
-- 3  | 3          | 3         | 3
```

### Oddiy so‘rovlar bilan tanishish
- Narxi 100 dan yuqori bo‘lgan mahsulotlarni tartiblang:  
```sql
SELECT * FROM products WHERE narxi > 100 ORDER BY narxi DESC;
-- Natija:
-- id | nomi    | narxi | turi
-- 2  | Noutbuk | 800   | Elektronika
-- 1  | Telefon | 500   | Elektronika
```

- Buyurtmalarni mijozlar va mahsulotlar bilan birlashtirish (JOIN):  
```sql
SELECT customers.ism, products.nomi, orders.miqdor
FROM orders
JOIN customers ON orders.customer_id = customers.id
JOIN products ON orders.product_id = products.id;
-- Natija:
-- ism    | nomi    | miqdor
-- Ali    | Telefon | 2
-- Zilola | Noutbuk | 1
-- Vali   | Kiyim   | 3
```

**Eslatma:** Bu darsda biz faqat so‘rovlar va natijalarni tasavvur qilamiz, chunki real ulanish muhitga bog‘liq.

Mashq: Quyidagi vazifani bajaring:  
- `categories` nomli jadval yarating (id, nomi).  
- 2 ta kategoriya qo‘shing (masalan, Elektronika, Moda).  
- Narxi 50 dan kichik bo‘lgan mahsulotlarni toping.  

5 daqiqa vaqt beraman!

---

## 3. Python bilan ma’lumotlarni boshqarish (20 daqiqa)

Ajoyib, endi Python yordamida loyihamizni boshqaramiz! `psycopg2` yordamida ma’lumotlarni qo‘shish, o‘zgartirish va olishni ko‘ramiz.

### Python’da ulanish va ma’lumotlar bilan ishlash
```python
import psycopg2

# PostgreSQL’ga ulanish
try:
    conn = psycopg2.connect(
        database="onlinedokon",
        user="postgres",
        password="admin123",
        host="localhost",
        port="5432"
    )
    cursor = conn.cursor()
    print("Bazaga ulanildi!")

    # Yangi mahsulot qo‘shish
    cursor.execute("INSERT INTO products (nomi, narxi, turi) VALUES (%s, %s, %s)", ("Sichqoncha", 15, "Elektronika"))
    conn.commit()

    # Narxi 100 dan yuqori bo‘lgan mahsulotlarni tartiblang
    cursor.execute("SELECT * FROM products WHERE narxi > %s ORDER BY narxi DESC", (100,))
    natija = cursor.fetchall()
    print("Narxi 100 dan yuqori mahsulotlar:", natija)
    # Natija: [(2, 'Noutbuk', 800, 'Elektronika'), (1, 'Telefon', 500, 'Elektronika')]

    # Buyurtmalarni mijozlar va mahsulotlar bilan birlashtirish
    cursor.execute("""
        SELECT customers.ism, products.nomi, orders.miqdor
        FROM orders
        JOIN customers ON orders.customer_id = customers.id
        JOIN products ON orders.product_id = products.id
    """)
    natija = cursor.fetchall()
    print("Buyurtmalar:", natija)
    # Natija: [('Ali', 'Telefon', 2), ('Zilola', 'Noutbuk', 1), ('Vali', 'Kiyim', 3)]

    # Ma’lumot o‘zgartirish: Telefon narxini 600 ga yangilash
    cursor.execute("UPDATE products SET narxi = %s WHERE nomi = %s", (600, "Telefon"))
    conn.commit()

    # Ma’lumot o‘chirish: Miqdori 1 dan kichik bo‘lgan buyurtmalarni o‘chirish
    cursor.execute("DELETE FROM orders WHERE miqdor < %s", (1,))
    conn.commit()

except psycopg2.Error as xato:
    print(f"Xato: {xato}")
finally:
    cursor.close()
    conn.close()
    print("Ulanish yopildi!")
```

**Tushuntirish:**  
- `psycopg2` yordamida bazaga ulandik.  
- Yangi mahsulot qo‘shdik, narx bo‘yicha filtrlash va tartiblash qildik.  
- JOIN yordamida buyurtmalarni birlashtirdik.  
- UPDATE va DELETE so‘rovlar bilan ma’lumotlarni boshqardik.  

**Eslatma:** Bu darsda biz faqat kodni ko‘rib chiqamiz, chunki real ulanish muhitga bog‘liq.

Mashq: Quyidagi vazifani bajaring:  
- Python’da yangi mijoz qo‘shing (masalan, Mohira).  
- Narxi 50 dan kichik bo‘lgan mahsulotlarni toping.  
- Buyurtmalarni mijozlar bilan birlashtirib, faqat miqdori 2 dan kichik bo‘lganlarni ko‘rsating.  

5 daqiqa vaqt beraman!

---

## 4. Amaliy mashqlar va loyiha kengaytirish (25 daqiqa)

Endi loyihamizni kengaytiramiz va amaliy mashqlar qilamiz!

### Mashq 1: SQL’da ma’lumotlar bilan ishlash
- `categories` jadvalini yarating va mahsulotlarni kategoriyalar bilan bog‘lang:  
```sql
CREATE TABLE categories (
    id SERIAL PRIMARY KEY,
    nomi VARCHAR(50)
);

INSERT INTO categories (nomi) VALUES ('Elektronika'), ('Moda');

-- products jadvaliga category_id qo‘shish
ALTER TABLE products ADD COLUMN category_id INTEGER REFERENCES categories(id);

-- Mahsulotlarni kategoriyalar bilan bog‘lash
UPDATE products SET category_id = 1 WHERE turi = 'Elektronika';
UPDATE products SET category_id = 2 WHERE turi = 'Moda';

-- Mahsulotlarni kategoriyalar bilan birlashtirish
SELECT products.nomi, products.narxi, categories.nomi AS kategoriya
FROM products
JOIN categories ON products.category_id = categories.id;
-- Natija:
-- nomi      | narxi | kategoriya
-- Telefon   | 600   | Elektronika
-- Noutbuk   | 800   | Elektronika
-- Kiyim     | 50    | Moda
-- Aksessuar | 20    | Moda
-- Sichqoncha| 15    | Elektronika
```

### Mashq 2: Python’da ma’lumotlar bilan ishlash
- Python’da yangi buyurtma qo‘shing va ma’lumotlarni filtrlash:  
```python
import psycopg2

try:
    conn = psycopg2.connect(
        database="onlinedokon",
        user="postgres",
        password="admin123",
        host="localhost",
        port="5432"
    )
    cursor = conn.cursor()

    # Yangi buyurtma qo‘shish
    cursor.execute("INSERT INTO orders (customer_id, product_id, miqdor) VALUES (%s, %s, %s)", (2, 4, 2))  # Zilola 2 ta Aksessuar sotib oldi
    conn.commit()

    # Miqdori 2 dan kichik bo‘lgan buyurtmalarni topish
    cursor.execute("""
        SELECT customers.ism, products.nomi, orders.miqdor
        FROM orders
        JOIN customers ON orders.customer_id = customers.id
        JOIN products ON orders.product_id = products.id
        WHERE orders.miqdor < %s
    """, (2,))
    natija = cursor.fetchall()
    print("Miqdori 2 dan kichik buyurtmalar:", natija)
    # Natija: [('Zilola', 'Noutbuk', 1)]

except psycopg2.Error as xato:
    print(f"Xato: {xato}")
finally:
    cursor.close()
    conn.close()
```

### Mashq 3: Loyiha kengaytirish
- `products` jadvalidagi eng qimmat mahsulotni toping:  
```sql
SELECT * FROM products ORDER BY narxi DESC LIMIT 1;
-- Natija:
-- id | nomi    | narxi | turi         | category_id
-- 2  | Noutbuk | 800   | Elektronika | 1
```

Har bir mashq uchun 8-9 daqiqa vaqt beraman. Kodlarni yozib, natijalarni ekranga chiqaring!

---

## 5. Xulosa va uy vazifasi (20 daqiqa)

Ajoyib, yosh dastanurchilar! 🎉 Bugun biz PostgreSQL’da onlayn do‘kon uchun kichik loyiha qildik. Ma’lumotlar bazasi va jadvallar yaratdik, ma’lumotlarni qo‘shdik, filtrladik, tartibladik va Python bilan boshqardik.

Uyga vazifa sifatida quyidagini qiling:  
1. `employees` nomli jadval yarating (id, ism, maosh) va `orders` bilan bog‘lang (masalan, har bir buyurtma uchun mas'ul xodim).  
2. Python’da yangi mahsulot qo‘shing va narxi 100 dan kichik bo‘lgan mahsulotlarni kategoriyalar bilan birlashtirib ko‘rsating.  
3. Eng ko‘p buyurtma bergan mijozni toping (JOIN va GROUP BY ishlatib).  

Darsimiz shu bilan tugadi, keyingi darsda esa `Django bilan tanishuv: Django o‘rnatish va sozlash` mavzusini o‘rganamiz. Savollaringiz bo‘lsa, yozib qoldiring yoki keyingi darsda so‘rang! 😊

---

## 6. Qayta ko'rib chiqish va savollar (10 daqiqa)

Zo‘r ish qildingiz! Endi bir oz o'rganganlarimizi qayta ko'rib chiqamiz. Bugungi darsda nimalarni o‘rgandik? Kim aytib bera oladi? (O‘quvchilar javobini kutaman.)

- Loyiha davomida qaysi so‘rovlar bilan ishladik?  
- JOIN qanday yordam berdi?  
- Python’da ma’lumotlarni boshqarish qanday amalga oshirildi?  

Qandaydir tushunmovchilik bo‘ldimi? Savollaringiz bormi? (O‘quvchilar savollarini eshitaman va tushuntiraman.) 😊

---