---

# ðŸ“š Darsning mavzusi: PostgreSQL bilan Loyiha â€“ Onlayn Doâ€˜kon Maâ€™lumotlar Bazasi

## Qisqacha vaqt taqsimoti

| Qism                          | Davomiyligi     |
|-------------------------------|-----------------|
| Kirish va loyiha haqida        | 20 daqiqa       |
| Maâ€™lumotlar bazasi va jadvallar yaratish | 25 daqiqa       |
| Python bilan maâ€™lumotlarni boshqarish | 20 daqiqa       |
| Amaliy mashqlar va loyiha kengaytirish | 25 daqiqa       |
| Xulosa va uy vazifasi         | 20 daqiqa       |
| Qayta aloqa va savollar       | 10 daqiqa       |
| Jami                          | 120 daqiqa (2 soat) |

Bu usul yoshlar uchun samarali, qiziqarli va tushunarli boâ€˜lib, oâ€˜quvchilarni dars jarayoniga faolroq jalb qiladi.

---

# ðŸ“– Darsning batafsil rejasi

## 1. Kirish va loyiha haqida (20 daqiqa)

Assalomu alaykum, yosh dasturchilar! ðŸ˜Š Bugun biz PostgreSQLâ€™da oâ€˜rgangan barcha bilimlarimizni amalda qoâ€˜llab, kichik bir loyiha qilamiz. Bizning loyihamiz â€“ **Onlayn Doâ€˜kon Maâ€™lumotlar Bazasi**. Bu loyiha orqali siz maâ€™lumotlar bazasi va jadvallarni yaratish, maâ€™lumotlarni qoâ€˜shish, filtrlash, tartiblash va Python bilan ishlashni oâ€˜rganasiz.

**Loyiha haqida:**  
Biz onlayn doâ€˜kon uchun maâ€™lumotlar bazasi tuzamiz. Unda quyidagi jadvallar boâ€˜ladi:  
- `products` (mahsulotlar): id, nomi, narxi, turi.  
- `customers` (mijozlar): id, ism, telefon.  
- `orders` (buyurtmalar): id, customer_id, product_id, miqdor.  

Bugun biz quyidagilarni amalga oshiramiz:  
- Maâ€™lumotlar bazasi va jadvallarni yaratish.  
- Maâ€™lumotlar qoâ€˜shish, filtrlash va tartiblash.  
- Python yordamida maâ€™lumotlarni boshqarish.  

**Nima uchun bu muhim?**  
Bu loyiha PostgreSQLâ€™dagi barcha bilimlaringizni birlashtiradi va real dunyo loyihalariga tayyorgarlik koâ€˜rishga yordam beradi.

Keling, bir savol: Onlayn doâ€˜kon maâ€™lumotlar bazasida qanday maâ€™lumotlarni saqlash kerak deb oâ€˜ylaysiz? (Oâ€˜quvchilar javobini kutaman, toâ€˜gâ€˜ri javob boâ€˜lsa: â€œAjoyib, toâ€˜gâ€˜ri!â€ deyman.)

Mashq: Quyidagi vazifani bajaring:  
- Onlayn doâ€˜kon uchun qanday jadvallar kerak boâ€˜lishi mumkinligini oâ€˜ylang (qogâ€˜ozda yoki fikr sifatida).  
- Qanday maâ€™lumotlarni filtrlash yoki tartiblash foydali boâ€˜ladi (masalan, narxi boâ€˜yicha tartiblash)?  

5 daqiqa vaqt beraman!

---

## 2. Maâ€™lumotlar bazasi va jadvallar yaratish (25 daqiqa)

Endi loyihamizni boshlaymiz! PostgreSQLâ€™da maâ€™lumotlar bazasi va jadvallar yaratamiz.

### Maâ€™lumotlar bazasi yaratish
```sql
-- Maâ€™lumotlar bazasi yaratish
CREATE DATABASE onlinedokon;
\c onlinedokon
```

### Jadvallar yaratish
Uchta jadval yaratamiz: `products`, `customers` va `orders`.

#### 1. `products` jadvali
```sql
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    nomi VARCHAR(50),
    narxi INTEGER,
    turi VARCHAR(20)
);

-- Maâ€™lumot qoâ€˜shish
INSERT INTO products (nomi, narxi, turi) VALUES ('Telefon', 500, 'Elektronika');
INSERT INTO products (nomi, narxi, turi) VALUES ('Noutbuk', 800, 'Elektronika');
INSERT INTO products (nomi, narxi, turi) VALUES ('Kiyim', 50, 'Moda');
INSERT INTO products (nomi, narxi, turi) VALUES ('Aksessuar', 20, 'Moda');

-- Maâ€™lumotlarni koâ€˜rish
SELECT * FROM products;
-- Natija:
-- id | nomi      | narxi | turi
-- 1  | Telefon   | 500   | Elektronika
-- 2  | Noutbuk   | 800   | Elektronika
-- 3  | Kiyim     | 50    | Moda
-- 4  | Aksessuar | 20    | Moda
```

#### 2. `customers` jadvali
```sql
CREATE TABLE customers (
    id SERIAL PRIMARY KEY,
    ism VARCHAR(50),
    telefon VARCHAR(20)
);

-- Maâ€™lumot qoâ€˜shish
INSERT INTO customers (ism, telefon) VALUES ('Ali', '+998901234567');
INSERT INTO customers (ism, telefon) VALUES ('Zilola', '+998907654321');
INSERT INTO customers (ism, telefon) VALUES ('Vali', '+998909876543');

-- Maâ€™lumotlarni koâ€˜rish
SELECT * FROM customers;
-- Natija:
-- id | ism    | telefon
-- 1  | Ali    | +998901234567
-- 2  | Zilola | +998907654321
-- 3  | Vali   | +998909876543
```

#### 3. `orders` jadvali
```sql
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    customer_id INTEGER REFERENCES customers(id),
    product_id INTEGER REFERENCES products(id),
    miqdor INTEGER
);

-- Maâ€™lumot qoâ€˜shish
INSERT INTO orders (customer_id, product_id, miqdor) VALUES (1, 1, 2); -- Ali 2 ta Telefon sotib oldi
INSERT INTO orders (customer_id, product_id, miqdor) VALUES (2, 2, 1); -- Zilola 1 ta Noutbuk sotib oldi
INSERT INTO orders (customer_id, product_id, miqdor) VALUES (3, 3, 3); -- Vali 3 ta Kiyim sotib oldi

-- Maâ€™lumotlarni koâ€˜rish
SELECT * FROM orders;
-- Natija:
-- id | customer_id | product_id | miqdor
-- 1  | 1          | 1         | 2
-- 2  | 2          | 2         | 1
-- 3  | 3          | 3         | 3
```

### Oddiy soâ€˜rovlar bilan tanishish
- Narxi 100 dan yuqori boâ€˜lgan mahsulotlarni tartiblang:  
```sql
SELECT * FROM products WHERE narxi > 100 ORDER BY narxi DESC;
-- Natija:
-- id | nomi    | narxi | turi
-- 2  | Noutbuk | 800   | Elektronika
-- 1  | Telefon | 500   | Elektronika
```

- Buyurtmalarni mijozlar va mahsulotlar bilan birlashtirish (JOIN):  
```sql
SELECT customers.ism, products.nomi, orders.miqdor
FROM orders
JOIN customers ON orders.customer_id = customers.id
JOIN products ON orders.product_id = products.id;
-- Natija:
-- ism    | nomi    | miqdor
-- Ali    | Telefon | 2
-- Zilola | Noutbuk | 1
-- Vali   | Kiyim   | 3
```

**Eslatma:** Bu darsda biz faqat soâ€˜rovlar va natijalarni tasavvur qilamiz, chunki real ulanish muhitga bogâ€˜liq.

Mashq: Quyidagi vazifani bajaring:  
- `categories` nomli jadval yarating (id, nomi).  
- 2 ta kategoriya qoâ€˜shing (masalan, Elektronika, Moda).  
- Narxi 50 dan kichik boâ€˜lgan mahsulotlarni toping.  

5 daqiqa vaqt beraman!

---

## 3. Python bilan maâ€™lumotlarni boshqarish (20 daqiqa)

Ajoyib, endi Python yordamida loyihamizni boshqaramiz! `psycopg2` yordamida maâ€™lumotlarni qoâ€˜shish, oâ€˜zgartirish va olishni koâ€˜ramiz.

### Pythonâ€™da ulanish va maâ€™lumotlar bilan ishlash
```python
import psycopg2

# PostgreSQLâ€™ga ulanish
try:
    conn = psycopg2.connect(
        database="onlinedokon",
        user="postgres",
        password="admin123",
        host="localhost",
        port="5432"
    )
    cursor = conn.cursor()
    print("Bazaga ulanildi!")

    # Yangi mahsulot qoâ€˜shish
    cursor.execute("INSERT INTO products (nomi, narxi, turi) VALUES (%s, %s, %s)", ("Sichqoncha", 15, "Elektronika"))
    conn.commit()

    # Narxi 100 dan yuqori boâ€˜lgan mahsulotlarni tartiblang
    cursor.execute("SELECT * FROM products WHERE narxi > %s ORDER BY narxi DESC", (100,))
    natija = cursor.fetchall()
    print("Narxi 100 dan yuqori mahsulotlar:", natija)
    # Natija: [(2, 'Noutbuk', 800, 'Elektronika'), (1, 'Telefon', 500, 'Elektronika')]

    # Buyurtmalarni mijozlar va mahsulotlar bilan birlashtirish
    cursor.execute("""
        SELECT customers.ism, products.nomi, orders.miqdor
        FROM orders
        JOIN customers ON orders.customer_id = customers.id
        JOIN products ON orders.product_id = products.id
    """)
    natija = cursor.fetchall()
    print("Buyurtmalar:", natija)
    # Natija: [('Ali', 'Telefon', 2), ('Zilola', 'Noutbuk', 1), ('Vali', 'Kiyim', 3)]

    # Maâ€™lumot oâ€˜zgartirish: Telefon narxini 600 ga yangilash
    cursor.execute("UPDATE products SET narxi = %s WHERE nomi = %s", (600, "Telefon"))
    conn.commit()

    # Maâ€™lumot oâ€˜chirish: Miqdori 1 dan kichik boâ€˜lgan buyurtmalarni oâ€˜chirish
    cursor.execute("DELETE FROM orders WHERE miqdor < %s", (1,))
    conn.commit()

except psycopg2.Error as xato:
    print(f"Xato: {xato}")
finally:
    cursor.close()
    conn.close()
    print("Ulanish yopildi!")
```

**Tushuntirish:**  
- `psycopg2` yordamida bazaga ulandik.  
- Yangi mahsulot qoâ€˜shdik, narx boâ€˜yicha filtrlash va tartiblash qildik.  
- JOIN yordamida buyurtmalarni birlashtirdik.  
- UPDATE va DELETE soâ€˜rovlar bilan maâ€™lumotlarni boshqardik.  

**Eslatma:** Bu darsda biz faqat kodni koâ€˜rib chiqamiz, chunki real ulanish muhitga bogâ€˜liq.

Mashq: Quyidagi vazifani bajaring:  
- Pythonâ€™da yangi mijoz qoâ€˜shing (masalan, Mohira).  
- Narxi 50 dan kichik boâ€˜lgan mahsulotlarni toping.  
- Buyurtmalarni mijozlar bilan birlashtirib, faqat miqdori 2 dan kichik boâ€˜lganlarni koâ€˜rsating.  

5 daqiqa vaqt beraman!

---

## 4. Amaliy mashqlar va loyiha kengaytirish (25 daqiqa)

Endi loyihamizni kengaytiramiz va amaliy mashqlar qilamiz!

### Mashq 1: SQLâ€™da maâ€™lumotlar bilan ishlash
- `categories` jadvalini yarating va mahsulotlarni kategoriyalar bilan bogâ€˜lang:  
```sql
CREATE TABLE categories (
    id SERIAL PRIMARY KEY,
    nomi VARCHAR(50)
);

INSERT INTO categories (nomi) VALUES ('Elektronika'), ('Moda');

-- products jadvaliga category_id qoâ€˜shish
ALTER TABLE products ADD COLUMN category_id INTEGER REFERENCES categories(id);

-- Mahsulotlarni kategoriyalar bilan bogâ€˜lash
UPDATE products SET category_id = 1 WHERE turi = 'Elektronika';
UPDATE products SET category_id = 2 WHERE turi = 'Moda';

-- Mahsulotlarni kategoriyalar bilan birlashtirish
SELECT products.nomi, products.narxi, categories.nomi AS kategoriya
FROM products
JOIN categories ON products.category_id = categories.id;
-- Natija:
-- nomi      | narxi | kategoriya
-- Telefon   | 600   | Elektronika
-- Noutbuk   | 800   | Elektronika
-- Kiyim     | 50    | Moda
-- Aksessuar | 20    | Moda
-- Sichqoncha| 15    | Elektronika
```

### Mashq 2: Pythonâ€™da maâ€™lumotlar bilan ishlash
- Pythonâ€™da yangi buyurtma qoâ€˜shing va maâ€™lumotlarni filtrlash:  
```python
import psycopg2

try:
    conn = psycopg2.connect(
        database="onlinedokon",
        user="postgres",
        password="admin123",
        host="localhost",
        port="5432"
    )
    cursor = conn.cursor()

    # Yangi buyurtma qoâ€˜shish
    cursor.execute("INSERT INTO orders (customer_id, product_id, miqdor) VALUES (%s, %s, %s)", (2, 4, 2))  # Zilola 2 ta Aksessuar sotib oldi
    conn.commit()

    # Miqdori 2 dan kichik boâ€˜lgan buyurtmalarni topish
    cursor.execute("""
        SELECT customers.ism, products.nomi, orders.miqdor
        FROM orders
        JOIN customers ON orders.customer_id = customers.id
        JOIN products ON orders.product_id = products.id
        WHERE orders.miqdor < %s
    """, (2,))
    natija = cursor.fetchall()
    print("Miqdori 2 dan kichik buyurtmalar:", natija)
    # Natija: [('Zilola', 'Noutbuk', 1)]

except psycopg2.Error as xato:
    print(f"Xato: {xato}")
finally:
    cursor.close()
    conn.close()
```

### Mashq 3: Loyiha kengaytirish
- `products` jadvalidagi eng qimmat mahsulotni toping:  
```sql
SELECT * FROM products ORDER BY narxi DESC LIMIT 1;
-- Natija:
-- id | nomi    | narxi | turi         | category_id
-- 2  | Noutbuk | 800   | Elektronika | 1
```

Har bir mashq uchun 8-9 daqiqa vaqt beraman. Kodlarni yozib, natijalarni ekranga chiqaring!

---

## 5. Xulosa va uy vazifasi (20 daqiqa)

Ajoyib, yosh dastanurchilar! ðŸŽ‰ Bugun biz PostgreSQLâ€™da onlayn doâ€˜kon uchun kichik loyiha qildik. Maâ€™lumotlar bazasi va jadvallar yaratdik, maâ€™lumotlarni qoâ€˜shdik, filtrladik, tartibladik va Python bilan boshqardik.

Uyga vazifa sifatida quyidagini qiling:  
1. `employees` nomli jadval yarating (id, ism, maosh) va `orders` bilan bogâ€˜lang (masalan, har bir buyurtma uchun mas'ul xodim).  
2. Pythonâ€™da yangi mahsulot qoâ€˜shing va narxi 100 dan kichik boâ€˜lgan mahsulotlarni kategoriyalar bilan birlashtirib koâ€˜rsating.  
3. Eng koâ€˜p buyurtma bergan mijozni toping (JOIN va GROUP BY ishlatib).  

Darsimiz shu bilan tugadi, keyingi darsda esa `Django bilan tanishuv: Django oâ€˜rnatish va sozlash` mavzusini oâ€˜rganamiz. Savollaringiz boâ€˜lsa, yozib qoldiring yoki keyingi darsda soâ€˜rang! ðŸ˜Š

---

## 6. Qayta ko'rib chiqish va savollar (10 daqiqa)

Zoâ€˜r ish qildingiz! Endi bir oz o'rganganlarimizi qayta ko'rib chiqamiz. Bugungi darsda nimalarni oâ€˜rgandik? Kim aytib bera oladi? (Oâ€˜quvchilar javobini kutaman.)

- Loyiha davomida qaysi soâ€˜rovlar bilan ishladik?  
- JOIN qanday yordam berdi?  
- Pythonâ€™da maâ€™lumotlarni boshqarish qanday amalga oshirildi?  

Qandaydir tushunmovchilik boâ€˜ldimi? Savollaringiz bormi? (Oâ€˜quvchilar savollarini eshitaman va tushuntiraman.) ðŸ˜Š

---